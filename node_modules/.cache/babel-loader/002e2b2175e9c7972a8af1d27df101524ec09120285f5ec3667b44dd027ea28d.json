{"ast":null,"code":"import{useEffect}from'react';export const TimelineMarker=_ref=>{let{adSegments}=_ref;useEffect(()=>{const injectMarkers=()=>{// Target specifically the ytp-timed-markers-container\nconst markersContainer=document.querySelector('.ytp-timed-markers-container');const progressBar=document.querySelector('.ytp-progress-bar');// Log what we found\nconsole.log('Target elements:',{markersContainer,progressBar});// If elements aren't found, retry after a short delay\nif(!markersContainer||!progressBar){console.log('Elements not found, will retry in 1 second');setTimeout(injectMarkers,1000);return;}// Clean up any existing markers\nconst existingMarkers=document.querySelectorAll('.yt-adskip-marker');existingMarkers.forEach(marker=>marker.remove());// Get video duration from the progress bar\nconst duration=Number(progressBar.getAttribute('aria-valuemax'))||0;if(!duration){console.log('No duration found, will retry in 1 second');setTimeout(injectMarkers,1000);return;}console.log('Adding markers for segments:',adSegments);// Create each marker directly in the markers container\nadSegments.forEach(segment=>{const marker=document.createElement('div');marker.className='yt-adskip-marker';// Calculate position\nconst startPercent=segment.start/duration*100;const endPercent=segment.end/duration*100;const width=endPercent-startPercent;// Style the marker\nObject.assign(marker.style,{position:'absolute',left:`${startPercent}%`,width:`${width}%`,height:'100%',backgroundColor:'rgba(255, 0, 0, 0.5)',pointerEvents:'none'});// Add directly to the markers container\nmarkersContainer.appendChild(marker);console.log('Added marker:',{start:segment.start,end:segment.end,width,element:marker});});};const setupSkipButton=()=>{// Remove any existing skip buttons\nconst existingButton=document.querySelector('.yt-adskip-button');if(existingButton)existingButton.remove();// Create skip button (hidden by default)\nconst skipButton=document.createElement('button');skipButton.className='yt-adskip-button ytp-button';skipButton.textContent='Skip Ad Section';skipButton.style.display='none';// Style the button\nObject.assign(skipButton.style,{position:'absolute',bottom:'60px',right:'20px',backgroundColor:'rgba(0, 0, 0, 0.7)',color:'white',border:'none',padding:'10px 20px',cursor:'pointer',zIndex:'2147483647',borderRadius:'4px'});// Add to player\nconst player=document.querySelector('.html5-video-player');if(player)player.appendChild(skipButton);// Monitor video time and show/hide skip button\nconst video=document.querySelector('video');if(!video)return;const checkAdSegment=()=>{const currentTime=video.currentTime;const activeSegment=adSegments.find(segment=>currentTime>=segment.start&&currentTime<segment.end);if(activeSegment){skipButton.style.display='block';skipButton.onclick=()=>{video.currentTime=activeSegment.end;skipButton.style.display='none';};}else{skipButton.style.display='none';}};video.addEventListener('timeupdate',checkAdSegment);};// Run setup\nconsole.log('Initial setup');injectMarkers();setupSkipButton();// Set up observer to detect player changes\nconst observer=new MutationObserver(()=>{console.log('Player changed, re-injecting markers');injectMarkers();});// Observe the whole document for player changes\nobserver.observe(document.documentElement,{childList:true,subtree:true});return()=>{observer.disconnect();const video=document.querySelector('video');if(video){video.removeEventListener('timeupdate',()=>{});}};},[adSegments]);return null;};","map":{"version":3,"names":["useEffect","TimelineMarker","_ref","adSegments","injectMarkers","markersContainer","document","querySelector","progressBar","console","log","setTimeout","existingMarkers","querySelectorAll","forEach","marker","remove","duration","Number","getAttribute","segment","createElement","className","startPercent","start","endPercent","end","width","Object","assign","style","position","left","height","backgroundColor","pointerEvents","appendChild","element","setupSkipButton","existingButton","skipButton","textContent","display","bottom","right","color","border","padding","cursor","zIndex","borderRadius","player","video","checkAdSegment","currentTime","activeSegment","find","onclick","addEventListener","observer","MutationObserver","observe","documentElement","childList","subtree","disconnect","removeEventListener"],"sources":["C:/Users/ADAM/YT-adskip/YT-adskip-extension/src/components/TimelineMarker.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { AdSegment } from '../utils/useVideoData';\n\ninterface TimelineMarkerProps {\n  adSegments: AdSegment[];\n}\n\nexport const TimelineMarker = ({ adSegments }: TimelineMarkerProps) => {\n  useEffect(() => {\n    const injectMarkers = () => {\n      // Target specifically the ytp-timed-markers-container\n      const markersContainer = document.querySelector('.ytp-timed-markers-container');\n      const progressBar = document.querySelector('.ytp-progress-bar');\n      \n      // Log what we found\n      console.log('Target elements:', { markersContainer, progressBar });\n      \n      // If elements aren't found, retry after a short delay\n      if (!markersContainer || !progressBar) {\n        console.log('Elements not found, will retry in 1 second');\n        setTimeout(injectMarkers, 1000);\n        return;\n      }\n\n      // Clean up any existing markers\n      const existingMarkers = document.querySelectorAll('.yt-adskip-marker');\n      existingMarkers.forEach(marker => marker.remove());\n\n      // Get video duration from the progress bar\n      const duration = Number(progressBar.getAttribute('aria-valuemax')) || 0;\n      if (!duration) {\n        console.log('No duration found, will retry in 1 second');\n        setTimeout(injectMarkers, 1000);\n        return;\n      }\n\n      console.log('Adding markers for segments:', adSegments);\n\n      // Create each marker directly in the markers container\n      adSegments.forEach(segment => {\n        const marker = document.createElement('div');\n        marker.className = 'yt-adskip-marker';\n        \n        // Calculate position\n        const startPercent = (segment.start / duration) * 100;\n        const endPercent = (segment.end / duration) * 100;\n        const width = endPercent - startPercent;\n        \n        // Style the marker\n        Object.assign(marker.style, {\n          position: 'absolute',\n          left: `${startPercent}%`,\n          width: `${width}%`,\n          height: '100%',\n          backgroundColor: 'rgba(255, 0, 0, 0.5)',\n          pointerEvents: 'none'\n        });\n        \n        // Add directly to the markers container\n        markersContainer.appendChild(marker);\n        console.log('Added marker:', { start: segment.start, end: segment.end, width, element: marker });\n      });\n    };\n\n    const setupSkipButton = () => {\n      // Remove any existing skip buttons\n      const existingButton = document.querySelector('.yt-adskip-button');\n      if (existingButton) existingButton.remove();\n\n      // Create skip button (hidden by default)\n      const skipButton = document.createElement('button');\n      skipButton.className = 'yt-adskip-button ytp-button';\n      skipButton.textContent = 'Skip Ad Section';\n      skipButton.style.display = 'none';\n      \n      // Style the button\n      Object.assign(skipButton.style, {\n        position: 'absolute',\n        bottom: '60px',\n        right: '20px',\n        backgroundColor: 'rgba(0, 0, 0, 0.7)',\n        color: 'white',\n        border: 'none',\n        padding: '10px 20px',\n        cursor: 'pointer',\n        zIndex: '2147483647',\n        borderRadius: '4px'\n      });\n\n      // Add to player\n      const player = document.querySelector('.html5-video-player') as HTMLElement;\n      if (player) player.appendChild(skipButton);\n\n      // Monitor video time and show/hide skip button\n      const video = document.querySelector('video') as HTMLVideoElement;\n      if (!video) return;\n\n      const checkAdSegment = () => {\n        const currentTime = video.currentTime;\n        const activeSegment = adSegments.find(\n          segment => currentTime >= segment.start && currentTime < segment.end\n        );\n\n        if (activeSegment) {\n          skipButton.style.display = 'block';\n          skipButton.onclick = () => {\n            video.currentTime = activeSegment.end;\n            skipButton.style.display = 'none';\n          };\n        } else {\n          skipButton.style.display = 'none';\n        }\n      };\n\n      video.addEventListener('timeupdate', checkAdSegment);\n    };\n\n    // Run setup\n    console.log('Initial setup');\n    injectMarkers();\n    setupSkipButton();\n\n    // Set up observer to detect player changes\n    const observer = new MutationObserver(() => {\n      console.log('Player changed, re-injecting markers');\n      injectMarkers();\n    });\n\n    // Observe the whole document for player changes\n    observer.observe(document.documentElement, {\n      childList: true,\n      subtree: true\n    });\n\n    return () => {\n      observer.disconnect();\n      const video = document.querySelector('video');\n      if (video) {\n        video.removeEventListener('timeupdate', () => {});\n      }\n    };\n  }, [adSegments]);\n\n  return null;\n}; "],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CAOjC,MAAO,MAAM,CAAAC,cAAc,CAAGC,IAAA,EAAyC,IAAxC,CAAEC,UAAgC,CAAC,CAAAD,IAAA,CAChEF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAI,aAAa,CAAGA,CAAA,GAAM,CAC1B;AACA,KAAM,CAAAC,gBAAgB,CAAGC,QAAQ,CAACC,aAAa,CAAC,8BAA8B,CAAC,CAC/E,KAAM,CAAAC,WAAW,CAAGF,QAAQ,CAACC,aAAa,CAAC,mBAAmB,CAAC,CAE/D;AACAE,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAE,CAAEL,gBAAgB,CAAEG,WAAY,CAAC,CAAC,CAElE;AACA,GAAI,CAACH,gBAAgB,EAAI,CAACG,WAAW,CAAE,CACrCC,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC,CACzDC,UAAU,CAACP,aAAa,CAAE,IAAI,CAAC,CAC/B,OACF,CAEA;AACA,KAAM,CAAAQ,eAAe,CAAGN,QAAQ,CAACO,gBAAgB,CAAC,mBAAmB,CAAC,CACtED,eAAe,CAACE,OAAO,CAACC,MAAM,EAAIA,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,CAElD;AACA,KAAM,CAAAC,QAAQ,CAAGC,MAAM,CAACV,WAAW,CAACW,YAAY,CAAC,eAAe,CAAC,CAAC,EAAI,CAAC,CACvE,GAAI,CAACF,QAAQ,CAAE,CACbR,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC,CACxDC,UAAU,CAACP,aAAa,CAAE,IAAI,CAAC,CAC/B,OACF,CAEAK,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEP,UAAU,CAAC,CAEvD;AACAA,UAAU,CAACW,OAAO,CAACM,OAAO,EAAI,CAC5B,KAAM,CAAAL,MAAM,CAAGT,QAAQ,CAACe,aAAa,CAAC,KAAK,CAAC,CAC5CN,MAAM,CAACO,SAAS,CAAG,kBAAkB,CAErC;AACA,KAAM,CAAAC,YAAY,CAAIH,OAAO,CAACI,KAAK,CAAGP,QAAQ,CAAI,GAAG,CACrD,KAAM,CAAAQ,UAAU,CAAIL,OAAO,CAACM,GAAG,CAAGT,QAAQ,CAAI,GAAG,CACjD,KAAM,CAAAU,KAAK,CAAGF,UAAU,CAAGF,YAAY,CAEvC;AACAK,MAAM,CAACC,MAAM,CAACd,MAAM,CAACe,KAAK,CAAE,CAC1BC,QAAQ,CAAE,UAAU,CACpBC,IAAI,CAAE,GAAGT,YAAY,GAAG,CACxBI,KAAK,CAAE,GAAGA,KAAK,GAAG,CAClBM,MAAM,CAAE,MAAM,CACdC,eAAe,CAAE,sBAAsB,CACvCC,aAAa,CAAE,MACjB,CAAC,CAAC,CAEF;AACA9B,gBAAgB,CAAC+B,WAAW,CAACrB,MAAM,CAAC,CACpCN,OAAO,CAACC,GAAG,CAAC,eAAe,CAAE,CAAEc,KAAK,CAAEJ,OAAO,CAACI,KAAK,CAAEE,GAAG,CAAEN,OAAO,CAACM,GAAG,CAAEC,KAAK,CAAEU,OAAO,CAAEtB,MAAO,CAAC,CAAC,CAClG,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAuB,eAAe,CAAGA,CAAA,GAAM,CAC5B;AACA,KAAM,CAAAC,cAAc,CAAGjC,QAAQ,CAACC,aAAa,CAAC,mBAAmB,CAAC,CAClE,GAAIgC,cAAc,CAAEA,cAAc,CAACvB,MAAM,CAAC,CAAC,CAE3C;AACA,KAAM,CAAAwB,UAAU,CAAGlC,QAAQ,CAACe,aAAa,CAAC,QAAQ,CAAC,CACnDmB,UAAU,CAAClB,SAAS,CAAG,6BAA6B,CACpDkB,UAAU,CAACC,WAAW,CAAG,iBAAiB,CAC1CD,UAAU,CAACV,KAAK,CAACY,OAAO,CAAG,MAAM,CAEjC;AACAd,MAAM,CAACC,MAAM,CAACW,UAAU,CAACV,KAAK,CAAE,CAC9BC,QAAQ,CAAE,UAAU,CACpBY,MAAM,CAAE,MAAM,CACdC,KAAK,CAAE,MAAM,CACbV,eAAe,CAAE,oBAAoB,CACrCW,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,WAAW,CACpBC,MAAM,CAAE,SAAS,CACjBC,MAAM,CAAE,YAAY,CACpBC,YAAY,CAAE,KAChB,CAAC,CAAC,CAEF;AACA,KAAM,CAAAC,MAAM,CAAG7C,QAAQ,CAACC,aAAa,CAAC,qBAAqB,CAAgB,CAC3E,GAAI4C,MAAM,CAAEA,MAAM,CAACf,WAAW,CAACI,UAAU,CAAC,CAE1C;AACA,KAAM,CAAAY,KAAK,CAAG9C,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAqB,CACjE,GAAI,CAAC6C,KAAK,CAAE,OAEZ,KAAM,CAAAC,cAAc,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAAC,WAAW,CAAGF,KAAK,CAACE,WAAW,CACrC,KAAM,CAAAC,aAAa,CAAGpD,UAAU,CAACqD,IAAI,CACnCpC,OAAO,EAAIkC,WAAW,EAAIlC,OAAO,CAACI,KAAK,EAAI8B,WAAW,CAAGlC,OAAO,CAACM,GACnE,CAAC,CAED,GAAI6B,aAAa,CAAE,CACjBf,UAAU,CAACV,KAAK,CAACY,OAAO,CAAG,OAAO,CAClCF,UAAU,CAACiB,OAAO,CAAG,IAAM,CACzBL,KAAK,CAACE,WAAW,CAAGC,aAAa,CAAC7B,GAAG,CACrCc,UAAU,CAACV,KAAK,CAACY,OAAO,CAAG,MAAM,CACnC,CAAC,CACH,CAAC,IAAM,CACLF,UAAU,CAACV,KAAK,CAACY,OAAO,CAAG,MAAM,CACnC,CACF,CAAC,CAEDU,KAAK,CAACM,gBAAgB,CAAC,YAAY,CAAEL,cAAc,CAAC,CACtD,CAAC,CAED;AACA5C,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC,CAC5BN,aAAa,CAAC,CAAC,CACfkC,eAAe,CAAC,CAAC,CAEjB;AACA,KAAM,CAAAqB,QAAQ,CAAG,GAAI,CAAAC,gBAAgB,CAAC,IAAM,CAC1CnD,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC,CACnDN,aAAa,CAAC,CAAC,CACjB,CAAC,CAAC,CAEF;AACAuD,QAAQ,CAACE,OAAO,CAACvD,QAAQ,CAACwD,eAAe,CAAE,CACzCC,SAAS,CAAE,IAAI,CACfC,OAAO,CAAE,IACX,CAAC,CAAC,CAEF,MAAO,IAAM,CACXL,QAAQ,CAACM,UAAU,CAAC,CAAC,CACrB,KAAM,CAAAb,KAAK,CAAG9C,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC,CAC7C,GAAI6C,KAAK,CAAE,CACTA,KAAK,CAACc,mBAAmB,CAAC,YAAY,CAAE,IAAM,CAAC,CAAC,CAAC,CACnD,CACF,CAAC,CACH,CAAC,CAAE,CAAC/D,UAAU,CAAC,CAAC,CAEhB,MAAO,KAAI,CACb,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}