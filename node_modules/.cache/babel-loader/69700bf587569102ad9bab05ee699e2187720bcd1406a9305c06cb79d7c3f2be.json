{"ast":null,"code":"import{useEffect}from'react';export const TimelineMarker=_ref=>{let{adSegments}=_ref;useEffect(()=>{const injectTimelineMarkers=()=>{// Wait for the YouTube player to be ready\nconst progressBar=document.querySelector('.ytp-progress-bar');const timeline=document.querySelector('.ytp-progress-bar-container');if(!progressBar||!timeline){// If elements aren't ready, retry after a short delay\nsetTimeout(injectTimelineMarkers,1000);return;}// Clear any existing markers\nconst existingMarkers=document.querySelectorAll('.yt-adskip-marker');existingMarkers.forEach(marker=>marker.remove());// Get video duration from the progress bar\nconst duration=Number(progressBar.getAttribute('aria-valuemax'))||0;if(!duration){setTimeout(injectTimelineMarkers,1000);return;}// Create container for markers if it doesn't exist\nlet markerContainer=document.querySelector('.yt-adskip-marker-container');if(!markerContainer){markerContainer=document.createElement('div');markerContainer.className='yt-adskip-marker-container';Object.assign(markerContainer.style,{position:'absolute',top:'0',left:'0',width:'100%',height:'100%',pointerEvents:'none',zIndex:'1'});timeline.appendChild(markerContainer);}// Create markers for each ad segment\nadSegments.forEach(segment=>{const marker=document.createElement('div');marker.className='yt-adskip-marker';// Calculate position and width\nconst startPercent=segment.start/duration*100;const endPercent=segment.end/duration*100;const width=endPercent-startPercent;// Style the marker\nObject.assign(marker.style,{position:'absolute',left:`${startPercent}%`,width:`${width}%`,height:'100%',backgroundColor:'rgba(255, 0, 0, 0.5)',pointerEvents:'none'});markerContainer.appendChild(marker);});};const setupSkipButton=()=>{// Remove any existing skip buttons\nconst existingButton=document.querySelector('.yt-adskip-button');if(existingButton)existingButton.remove();// Create skip button (hidden by default)\nconst skipButton=document.createElement('button');skipButton.className='yt-adskip-button ytp-button';skipButton.textContent='Skip Ad Section';skipButton.style.display='none';// Style the button\nObject.assign(skipButton.style,{position:'absolute',bottom:'60px',right:'20px',backgroundColor:'rgba(0, 0, 0, 0.7)',color:'white',border:'none',padding:'10px 20px',cursor:'pointer',zIndex:'2147483647',borderRadius:'4px'});// Add to player\nconst player=document.querySelector('.html5-video-player');if(player)player.appendChild(skipButton);// Monitor video time and show/hide skip button\nconst video=document.querySelector('video');if(!video)return;const checkAdSegment=()=>{const currentTime=video.currentTime;const activeSegment=adSegments.find(segment=>currentTime>=segment.start&&currentTime<segment.end);if(activeSegment){skipButton.style.display='block';skipButton.onclick=()=>{video.currentTime=activeSegment.end;skipButton.style.display='none';};}else{skipButton.style.display='none';}};video.addEventListener('timeupdate',checkAdSegment);};// Initial setup with retry mechanism\nconst setup=()=>{injectTimelineMarkers();setupSkipButton();};setup();// Re-run setup when navigating to a new video\nconst observer=new MutationObserver(mutations=>{for(const mutation of mutations){if(mutation.target.nodeName==='VIDEO'||mutation.target.classList.contains('ytp-progress-bar')){setup();break;}}});observer.observe(document.body,{childList:true,subtree:true,attributes:true,attributeFilter:['src','aria-valuemax']});return()=>{observer.disconnect();const video=document.querySelector('video');if(video){video.removeEventListener('timeupdate',()=>{});}};},[adSegments]);return null;};","map":{"version":3,"names":["useEffect","TimelineMarker","_ref","adSegments","injectTimelineMarkers","progressBar","document","querySelector","timeline","setTimeout","existingMarkers","querySelectorAll","forEach","marker","remove","duration","Number","getAttribute","markerContainer","createElement","className","Object","assign","style","position","top","left","width","height","pointerEvents","zIndex","appendChild","segment","startPercent","start","endPercent","end","backgroundColor","setupSkipButton","existingButton","skipButton","textContent","display","bottom","right","color","border","padding","cursor","borderRadius","player","video","checkAdSegment","currentTime","activeSegment","find","onclick","addEventListener","setup","observer","MutationObserver","mutations","mutation","target","nodeName","classList","contains","observe","body","childList","subtree","attributes","attributeFilter","disconnect","removeEventListener"],"sources":["C:/Users/ADAM/YT-adskip/YT-adskip-extension/src/components/TimelineMarker.tsx"],"sourcesContent":["import { useEffect } from 'react';\r\nimport { AdSegment } from '../utils/useVideoData';\r\n\r\ninterface TimelineMarkerProps {\r\n  adSegments: AdSegment[];\r\n}\r\n\r\nexport const TimelineMarker = ({ adSegments }: TimelineMarkerProps) => {\r\n  useEffect(() => {\r\n    const injectTimelineMarkers = () => {\r\n      // Wait for the YouTube player to be ready\r\n      const progressBar = document.querySelector('.ytp-progress-bar');\r\n      const timeline = document.querySelector('.ytp-progress-bar-container');\r\n      if (!progressBar || !timeline) {\r\n        // If elements aren't ready, retry after a short delay\r\n        setTimeout(injectTimelineMarkers, 1000);\r\n        return;\r\n      }\r\n\r\n      // Clear any existing markers\r\n      const existingMarkers = document.querySelectorAll('.yt-adskip-marker');\r\n      existingMarkers.forEach(marker => marker.remove());\r\n\r\n      // Get video duration from the progress bar\r\n      const duration = Number(progressBar.getAttribute('aria-valuemax')) || 0;\r\n      if (!duration) {\r\n        setTimeout(injectTimelineMarkers, 1000);\r\n        return;\r\n      }\r\n\r\n      // Create container for markers if it doesn't exist\r\n      let markerContainer = document.querySelector('.yt-adskip-marker-container');\r\n      if (!markerContainer) {\r\n        markerContainer = document.createElement('div');\r\n        markerContainer.className = 'yt-adskip-marker-container';\r\n        Object.assign(markerContainer.style, {\r\n          position: 'absolute',\r\n          top: '0',\r\n          left: '0',\r\n          width: '100%',\r\n          height: '100%',\r\n          pointerEvents: 'none',\r\n          zIndex: '1'\r\n        });\r\n        timeline.appendChild(markerContainer);\r\n      }\r\n\r\n      // Create markers for each ad segment\r\n      adSegments.forEach(segment => {\r\n        const marker = document.createElement('div');\r\n        marker.className = 'yt-adskip-marker';\r\n        \r\n        // Calculate position and width\r\n        const startPercent = (segment.start / duration) * 100;\r\n        const endPercent = (segment.end / duration) * 100;\r\n        const width = endPercent - startPercent;\r\n        \r\n        // Style the marker\r\n        Object.assign(marker.style, {\r\n          position: 'absolute',\r\n          left: `${startPercent}%`,\r\n          width: `${width}%`,\r\n          height: '100%',\r\n          backgroundColor: 'rgba(255, 0, 0, 0.5)',\r\n          pointerEvents: 'none'\r\n        });\r\n        \r\n        markerContainer.appendChild(marker);\r\n      });\r\n    };\r\n\r\n    const setupSkipButton = () => {\r\n      // Remove any existing skip buttons\r\n      const existingButton = document.querySelector('.yt-adskip-button');\r\n      if (existingButton) existingButton.remove();\r\n\r\n      // Create skip button (hidden by default)\r\n      const skipButton = document.createElement('button');\r\n      skipButton.className = 'yt-adskip-button ytp-button';\r\n      skipButton.textContent = 'Skip Ad Section';\r\n      skipButton.style.display = 'none';\r\n      \r\n      // Style the button\r\n      Object.assign(skipButton.style, {\r\n        position: 'absolute',\r\n        bottom: '60px',\r\n        right: '20px',\r\n        backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n        color: 'white',\r\n        border: 'none',\r\n        padding: '10px 20px',\r\n        cursor: 'pointer',\r\n        zIndex: '2147483647',\r\n        borderRadius: '4px'\r\n      });\r\n\r\n      // Add to player\r\n      const player = document.querySelector('.html5-video-player');\r\n      if (player) player.appendChild(skipButton);\r\n\r\n      // Monitor video time and show/hide skip button\r\n      const video = document.querySelector('video');\r\n      if (!video) return;\r\n\r\n      const checkAdSegment = () => {\r\n        const currentTime = video.currentTime;\r\n        const activeSegment = adSegments.find(\r\n          segment => currentTime >= segment.start && currentTime < segment.end\r\n        );\r\n\r\n        if (activeSegment) {\r\n          skipButton.style.display = 'block';\r\n          skipButton.onclick = () => {\r\n            video.currentTime = activeSegment.end;\r\n            skipButton.style.display = 'none';\r\n          };\r\n        } else {\r\n          skipButton.style.display = 'none';\r\n        }\r\n      };\r\n\r\n      video.addEventListener('timeupdate', checkAdSegment);\r\n    };\r\n\r\n    // Initial setup with retry mechanism\r\n    const setup = () => {\r\n      injectTimelineMarkers();\r\n      setupSkipButton();\r\n    };\r\n    setup();\r\n\r\n    // Re-run setup when navigating to a new video\r\n    const observer = new MutationObserver((mutations) => {\r\n      for (const mutation of mutations) {\r\n        if (mutation.target.nodeName === 'VIDEO' || \r\n            mutation.target.classList.contains('ytp-progress-bar')) {\r\n          setup();\r\n          break;\r\n        }\r\n      }\r\n    });\r\n\r\n    observer.observe(document.body, {\r\n      childList: true,\r\n      subtree: true,\r\n      attributes: true,\r\n      attributeFilter: ['src', 'aria-valuemax']\r\n    });\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n      const video = document.querySelector('video');\r\n      if (video) {\r\n        video.removeEventListener('timeupdate', () => {});\r\n      }\r\n    };\r\n  }, [adSegments]);\r\n\r\n  return null;\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}