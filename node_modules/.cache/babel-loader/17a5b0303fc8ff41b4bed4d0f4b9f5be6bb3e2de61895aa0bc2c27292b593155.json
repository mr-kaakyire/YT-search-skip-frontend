{"ast":null,"code":"import React,{useState,useEffect}from'react';import{ThemeProvider,createTheme}from'@mui/material/styles';import CssBaseline from'@mui/material/CssBaseline';import Box from'@mui/material/Box';import CircularProgress from'@mui/material/CircularProgress';import Alert from'@mui/material/Alert';import{SearchResults}from'./components/SearchResults';import{SearchBar}from'./components/SearchBar';import{AdMarker}from'./components/AdMarker';import{useVideoData}from'./utils/useVideoData';import{useThemeDetector}from'./utils/useThemeDetector';// Add global declaration for the adSkipObserver property\n// Custom event interface for type safety\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[videoId,setVideoId]=useState('');const[searchQuery,setSearchQuery]=useState('');const isYouTubeDark=useThemeDetector();const theme=createTheme({palette:{mode:isYouTubeDark?'dark':'light',primary:{main:'#ff0000'// YouTube red\n},background:{default:isYouTubeDark?'#0f0f0f':'#ffffff',paper:isYouTubeDark?'#272727':'#ffffff'}}});const{data,loading,error,fetchData}=useVideoData();useEffect(()=>{// Get current tab's URL to extract video ID\nchrome.tabs.query({active:true,currentWindow:true},tabs=>{var _tabs$;const url=((_tabs$=tabs[0])===null||_tabs$===void 0?void 0:_tabs$.url)||'';const urlParams=new URLSearchParams(new URL(url).search);const id=urlParams.get('v');if(id){setVideoId(id);fetchData(id);}});},[]);useEffect(()=>{if(data!==null&&data!==void 0&&data.adSegments&&data.adSegments.length>0){chrome.tabs.query({active:true,currentWindow:true},tabs=>{var _tabs$2;const tabId=(_tabs$2=tabs[0])===null||_tabs$2===void 0?void 0:_tabs$2.id;if(tabId){// First inject the content script\nchrome.scripting.executeScript({target:{tabId},files:['content.js']}).then(()=>{// Then inject the markers script with the ad segments data\nchrome.scripting.executeScript({target:{tabId},func:segments=>{// Prevent multiple setups which can cause performance issues\nif(window.ytAdSkipSetup){console.log('YT AdSkip already set up, refreshing markers');// Just refresh the markers\nconst refreshEvent=new CustomEvent('yt-adskip-refresh',{detail:segments});document.dispatchEvent(refreshEvent);return;}// Mark as set up to prevent duplicate processing\nwindow.ytAdSkipSetup=true;// Store segments in a variable that persists across calls\nlet currentSegments=segments;// Function that will run in the context of the YouTube page\nconst injectMarkers=()=>{// Target specifically the ytp-timed-markers-container\nconst markersContainer=document.querySelector('.ytp-timed-markers-container');const progressBar=document.querySelector('.ytp-progress-bar');// If elements aren't found, retry after a short delay but limit retries\nif(!markersContainer||!progressBar){return;}// Clean up any existing markers to prevent duplicates\nconst existingMarkers=document.querySelectorAll('.yt-adskip-marker');existingMarkers.forEach(marker=>marker.remove());// Get video duration from the progress bar\nconst duration=Number(progressBar.getAttribute('aria-valuemax'))||0;if(!duration){return;}// Create each marker directly in the markers container - use DocumentFragment for performance\nconst fragment=document.createDocumentFragment();currentSegments.forEach(segment=>{const marker=document.createElement('div');marker.className='yt-adskip-marker';// Calculate position\nconst startPercent=segment.start/duration*100;const endPercent=segment.end/duration*100;const width=endPercent-startPercent;// Style the marker\nObject.assign(marker.style,{position:'absolute',left:`${startPercent}%`,width:`${width}%`,height:'100%',backgroundColor:'rgba(255, 0, 0, 0.5)',pointerEvents:'none'});fragment.appendChild(marker);});// Add all markers at once for better performance\nmarkersContainer.appendChild(fragment);};// Set up skip button - do this only once\nconst setupSkipButton=()=>{// Remove any existing skip buttons\nconst existingButton=document.querySelector('.yt-adskip-button');if(existingButton)existingButton.remove();// Create skip button (hidden by default)\nconst skipButton=document.createElement('button');skipButton.className='yt-adskip-button ytp-button';skipButton.textContent='Skip Ad Section';skipButton.style.display='none';// Add to player\nconst player=document.querySelector('.html5-video-player');if(player)player.appendChild(skipButton);// Monitor video time and show/hide skip button - use requestAnimationFrame for better performance\nconst video=document.querySelector('video');if(!video)return;let animationFrameId=null;let lastCheckTime=0;const checkAdSegment=()=>{// Throttle checks to reduce CPU usage - check only every 500ms\nconst now=Date.now();if(now-lastCheckTime<500){animationFrameId=requestAnimationFrame(checkAdSegment);return;}lastCheckTime=now;const currentTime=video.currentTime;const activeSegment=currentSegments.find(segment=>currentTime>=segment.start&&currentTime<segment.end);if(activeSegment){skipButton.style.display='block';skipButton.onclick=()=>{video.currentTime=activeSegment.end;skipButton.style.display='none';};}else{skipButton.style.display='none';}animationFrameId=requestAnimationFrame(checkAdSegment);};// Start the animation frame loop\nanimationFrameId=requestAnimationFrame(checkAdSegment);// Clean up function to be called when needed\nreturn()=>{if(animationFrameId){cancelAnimationFrame(animationFrameId);}};};// Initial setup\ninjectMarkers();const cleanup=setupSkipButton();// Listen for refresh events\ndocument.addEventListener('yt-adskip-refresh',event=>{// Update segments if provided\nconst customEvent=event;if(customEvent.detail){currentSegments=customEvent.detail;}injectMarkers();});// Set up a targeted observer with efficiency in mind\nif(!window.adSkipObserver){// Only observe the progress bar and markers container for changes\nconst container=document.querySelector('.ytp-chrome-bottom')||document.body;window.adSkipObserver=new MutationObserver(mutations=>{// Check if progress bar or markers container changed\nfor(const mutation of mutations){const target=mutation.target;if(target.classList&&(target.classList.contains('ytp-progress-bar')||target.classList.contains('ytp-timed-markers-container'))){injectMarkers();break;}}});window.adSkipObserver.observe(container,{childList:true,subtree:true,attributes:true,attributeFilter:['aria-valuemax','style']});}// Cleanup when navigating away\nwindow.addEventListener('beforeunload',()=>{if(window.adSkipObserver){window.adSkipObserver.disconnect();}if(cleanup){cleanup();}});},args:[data.adSegments]});});}});}},[data===null||data===void 0?void 0:data.adSegments]);const handleSearch=query=>{setSearchQuery(query);};const handleTimestampClick=timestamp=>{chrome.tabs.query({active:true,currentWindow:true},tabs=>{var _tabs$3;const tabId=(_tabs$3=tabs[0])===null||_tabs$3===void 0?void 0:_tabs$3.id;if(tabId){chrome.scripting.executeScript({target:{tabId},func:time=>{const video=document.querySelector('video');if(video){video.currentTime=time;video.play();}},args:[timestamp]});}});};return/*#__PURE__*/_jsxs(ThemeProvider,{theme:theme,children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(Box,{sx:{width:400,minHeight:500,p:2,display:'flex',flexDirection:'column',gap:2},children:[/*#__PURE__*/_jsx(SearchBar,{onSearch:handleSearch,disabled:loading||!videoId}),loading&&/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:4},children:/*#__PURE__*/_jsx(CircularProgress,{})}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:error}),data&&/*#__PURE__*/_jsxs(_Fragment,{children:[data.adSegments&&data.adSegments.length>0&&/*#__PURE__*/_jsx(AdMarker,{adSegments:data.adSegments,onTimestampClick:handleTimestampClick}),/*#__PURE__*/_jsx(SearchResults,{transcript:data.transcript,searchQuery:searchQuery,onTimestampClick:handleTimestampClick})]})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","ThemeProvider","createTheme","CssBaseline","Box","CircularProgress","Alert","SearchResults","SearchBar","AdMarker","useVideoData","useThemeDetector","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","App","videoId","setVideoId","searchQuery","setSearchQuery","isYouTubeDark","theme","palette","mode","primary","main","background","default","paper","data","loading","error","fetchData","chrome","tabs","query","active","currentWindow","_tabs$","url","urlParams","URLSearchParams","URL","search","id","get","adSegments","length","_tabs$2","tabId","scripting","executeScript","target","files","then","func","segments","window","ytAdSkipSetup","console","log","refreshEvent","CustomEvent","detail","document","dispatchEvent","currentSegments","injectMarkers","markersContainer","querySelector","progressBar","existingMarkers","querySelectorAll","forEach","marker","remove","duration","Number","getAttribute","fragment","createDocumentFragment","segment","createElement","className","startPercent","start","endPercent","end","width","Object","assign","style","position","left","height","backgroundColor","pointerEvents","appendChild","setupSkipButton","existingButton","skipButton","textContent","display","player","video","animationFrameId","lastCheckTime","checkAdSegment","now","Date","requestAnimationFrame","currentTime","activeSegment","find","onclick","cancelAnimationFrame","cleanup","addEventListener","event","customEvent","adSkipObserver","container","body","MutationObserver","mutations","mutation","classList","contains","observe","childList","subtree","attributes","attributeFilter","disconnect","args","handleSearch","handleTimestampClick","timestamp","_tabs$3","time","play","children","sx","minHeight","p","flexDirection","gap","onSearch","disabled","justifyContent","severity","onTimestampClick","transcript"],"sources":["C:/Users/ADAM/YT-adskip/YT-adskip-extension/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { ThemeProvider, createTheme } from '@mui/material/styles';\r\nimport CssBaseline from '@mui/material/CssBaseline';\r\nimport Box from '@mui/material/Box';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\nimport Alert from '@mui/material/Alert';\r\nimport { SearchResults } from './components/SearchResults';\r\nimport { SearchBar } from './components/SearchBar';\r\nimport { AdMarker } from './components/AdMarker';\r\nimport { TimelineMarker } from './components/TimelineMarker';\r\nimport { useVideoData } from './utils/useVideoData';\r\nimport { useThemeDetector } from './utils/useThemeDetector';\r\n\r\n// Add global declaration for the adSkipObserver property\r\ndeclare global {\r\n  interface Window {\r\n    adSkipObserver?: MutationObserver;\r\n    ytAdSkipSetup?: boolean;\r\n  }\r\n}\r\n\r\n// Custom event interface for type safety\r\ninterface RefreshEvent extends CustomEvent {\r\n  detail: any;\r\n}\r\n\r\nconst App: React.FC = () => {\r\n  const [videoId, setVideoId] = useState<string>('');\r\n  const [searchQuery, setSearchQuery] = useState<string>('');\r\n  const isYouTubeDark = useThemeDetector();\r\n  \r\n  const theme = createTheme({\r\n    palette: {\r\n      mode: isYouTubeDark ? 'dark' : 'light',\r\n      primary: {\r\n        main: '#ff0000', // YouTube red\r\n      },\r\n      background: {\r\n        default: isYouTubeDark ? '#0f0f0f' : '#ffffff',\r\n        paper: isYouTubeDark ? '#272727' : '#ffffff',\r\n      },\r\n    },\r\n  });\r\n\r\n  const {\r\n    data,\r\n    loading,\r\n    error,\r\n    fetchData\r\n  } = useVideoData();\r\n\r\n  useEffect(() => {\r\n    // Get current tab's URL to extract video ID\r\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n      const url = tabs[0]?.url || '';\r\n      const urlParams = new URLSearchParams(new URL(url).search);\r\n      const id = urlParams.get('v');\r\n      if (id) {\r\n        setVideoId(id);\r\n        fetchData(id);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (data?.adSegments && data.adSegments.length > 0) {\r\n      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n        const tabId = tabs[0]?.id;\r\n        if (tabId) {\r\n          // First inject the content script\r\n          chrome.scripting.executeScript({\r\n            target: { tabId },\r\n            files: ['content.js']\r\n          }).then(() => {\r\n            // Then inject the markers script with the ad segments data\r\n            chrome.scripting.executeScript({\r\n              target: { tabId },\r\n              func: (segments) => {\r\n                // Prevent multiple setups which can cause performance issues\r\n                if (window.ytAdSkipSetup) {\r\n                  console.log('YT AdSkip already set up, refreshing markers');\r\n                  // Just refresh the markers\r\n                  const refreshEvent = new CustomEvent('yt-adskip-refresh', { detail: segments });\r\n                  document.dispatchEvent(refreshEvent);\r\n                  return;\r\n                }\r\n                \r\n                // Mark as set up to prevent duplicate processing\r\n                window.ytAdSkipSetup = true;\r\n                \r\n                // Store segments in a variable that persists across calls\r\n                let currentSegments = segments;\r\n\r\n                // Function that will run in the context of the YouTube page\r\n                const injectMarkers = () => {\r\n                  // Target specifically the ytp-timed-markers-container\r\n                  const markersContainer = document.querySelector('.ytp-timed-markers-container');\r\n                  const progressBar = document.querySelector('.ytp-progress-bar');\r\n                  \r\n                  // If elements aren't found, retry after a short delay but limit retries\r\n                  if (!markersContainer || !progressBar) {\r\n                    return;\r\n                  }\r\n\r\n                  // Clean up any existing markers to prevent duplicates\r\n                  const existingMarkers = document.querySelectorAll('.yt-adskip-marker');\r\n                  existingMarkers.forEach(marker => marker.remove());\r\n\r\n                  // Get video duration from the progress bar\r\n                  const duration = Number(progressBar.getAttribute('aria-valuemax')) || 0;\r\n                  if (!duration) {\r\n                    return;\r\n                  }\r\n\r\n                  // Create each marker directly in the markers container - use DocumentFragment for performance\r\n                  const fragment = document.createDocumentFragment();\r\n                  \r\n                  currentSegments.forEach(segment => {\r\n                    const marker = document.createElement('div');\r\n                    marker.className = 'yt-adskip-marker';\r\n                    \r\n                    // Calculate position\r\n                    const startPercent = (segment.start / duration) * 100;\r\n                    const endPercent = (segment.end / duration) * 100;\r\n                    const width = endPercent - startPercent;\r\n                    \r\n                    // Style the marker\r\n                    Object.assign(marker.style, {\r\n                      position: 'absolute',\r\n                      left: `${startPercent}%`,\r\n                      width: `${width}%`,\r\n                      height: '100%',\r\n                      backgroundColor: 'rgba(255, 0, 0, 0.5)',\r\n                      pointerEvents: 'none'\r\n                    });\r\n                    \r\n                    fragment.appendChild(marker);\r\n                  });\r\n                  \r\n                  // Add all markers at once for better performance\r\n                  markersContainer.appendChild(fragment);\r\n                };\r\n\r\n                // Set up skip button - do this only once\r\n                const setupSkipButton = () => {\r\n                  // Remove any existing skip buttons\r\n                  const existingButton = document.querySelector('.yt-adskip-button');\r\n                  if (existingButton) existingButton.remove();\r\n\r\n                  // Create skip button (hidden by default)\r\n                  const skipButton = document.createElement('button');\r\n                  skipButton.className = 'yt-adskip-button ytp-button';\r\n                  skipButton.textContent = 'Skip Ad Section';\r\n                  skipButton.style.display = 'none';\r\n                  \r\n                  // Add to player\r\n                  const player = document.querySelector('.html5-video-player');\r\n                  if (player) player.appendChild(skipButton);\r\n\r\n                  // Monitor video time and show/hide skip button - use requestAnimationFrame for better performance\r\n                  const video = document.querySelector('video');\r\n                  if (!video) return;\r\n\r\n                  let animationFrameId: number | null = null;\r\n                  let lastCheckTime = 0;\r\n                  \r\n                  const checkAdSegment = () => {\r\n                    // Throttle checks to reduce CPU usage - check only every 500ms\r\n                    const now = Date.now();\r\n                    if (now - lastCheckTime < 500) {\r\n                      animationFrameId = requestAnimationFrame(checkAdSegment);\r\n                      return;\r\n                    }\r\n                    \r\n                    lastCheckTime = now;\r\n                    const currentTime = video.currentTime;\r\n                    const activeSegment = currentSegments.find(\r\n                      segment => currentTime >= segment.start && currentTime < segment.end\r\n                    );\r\n\r\n                    if (activeSegment) {\r\n                      skipButton.style.display = 'block';\r\n                      skipButton.onclick = () => {\r\n                        video.currentTime = activeSegment.end;\r\n                        skipButton.style.display = 'none';\r\n                      };\r\n                    } else {\r\n                      skipButton.style.display = 'none';\r\n                    }\r\n                    \r\n                    animationFrameId = requestAnimationFrame(checkAdSegment);\r\n                  };\r\n\r\n                  // Start the animation frame loop\r\n                  animationFrameId = requestAnimationFrame(checkAdSegment);\r\n                  \r\n                  // Clean up function to be called when needed\r\n                  return () => {\r\n                    if (animationFrameId) {\r\n                      cancelAnimationFrame(animationFrameId);\r\n                    }\r\n                  };\r\n                };\r\n\r\n                // Initial setup\r\n                injectMarkers();\r\n                const cleanup = setupSkipButton();\r\n                \r\n                // Listen for refresh events\r\n                document.addEventListener('yt-adskip-refresh', ((event: Event) => {\r\n                  // Update segments if provided\r\n                  const customEvent = event as RefreshEvent;\r\n                  if (customEvent.detail) {\r\n                    currentSegments = customEvent.detail;\r\n                  }\r\n                  injectMarkers();\r\n                }) as EventListener);\r\n\r\n                // Set up a targeted observer with efficiency in mind\r\n                if (!window.adSkipObserver) {\r\n                  // Only observe the progress bar and markers container for changes\r\n                  const container = document.querySelector('.ytp-chrome-bottom') || document.body;\r\n                  \r\n                  window.adSkipObserver = new MutationObserver((mutations) => {\r\n                    // Check if progress bar or markers container changed\r\n                    for (const mutation of mutations) {\r\n                      const target = mutation.target as Element;\r\n                      if (target.classList && \r\n                          (target.classList.contains('ytp-progress-bar') || \r\n                           target.classList.contains('ytp-timed-markers-container'))) {\r\n                        injectMarkers();\r\n                        break;\r\n                      }\r\n                    }\r\n                  });\r\n                  \r\n                  window.adSkipObserver.observe(container, {\r\n                    childList: true,\r\n                    subtree: true,\r\n                    attributes: true,\r\n                    attributeFilter: ['aria-valuemax', 'style']\r\n                  });\r\n                }\r\n                \r\n                // Cleanup when navigating away\r\n                window.addEventListener('beforeunload', () => {\r\n                  if (window.adSkipObserver) {\r\n                    window.adSkipObserver.disconnect();\r\n                  }\r\n                  if (cleanup) {\r\n                    cleanup();\r\n                  }\r\n                });\r\n              },\r\n              args: [data.adSegments]\r\n            });\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }, [data?.adSegments]);\r\n\r\n  const handleSearch = (query: string) => {\r\n    setSearchQuery(query);\r\n  };\r\n\r\n  const handleTimestampClick = (timestamp: number) => {\r\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n      const tabId = tabs[0]?.id;\r\n      if (tabId) {\r\n        chrome.scripting.executeScript({\r\n          target: { tabId },\r\n          func: (time) => {\r\n            const video = document.querySelector('video');\r\n            if (video) {\r\n              video.currentTime = time;\r\n              video.play();\r\n            }\r\n          },\r\n          args: [timestamp]\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline />\r\n      <Box sx={{ \r\n        width: 400, \r\n        minHeight: 500,\r\n        p: 2,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: 2\r\n      }}>\r\n        <SearchBar \r\n          onSearch={handleSearch}\r\n          disabled={loading || !videoId}\r\n        />\r\n        \r\n        {loading && (\r\n          <Box sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>\r\n            <CircularProgress />\r\n          </Box>\r\n        )}\r\n\r\n        {error && (\r\n          <Alert severity=\"error\">\r\n            {error}\r\n          </Alert>\r\n        )}\r\n\r\n        {data && (\r\n          <>\r\n            {data.adSegments && data.adSegments.length > 0 && (\r\n              <AdMarker \r\n                adSegments={data.adSegments}\r\n                onTimestampClick={handleTimestampClick}\r\n              />\r\n            )}\r\n            \r\n            <SearchResults \r\n              transcript={data.transcript}\r\n              searchQuery={searchQuery}\r\n              onTimestampClick={handleTimestampClick}\r\n            />\r\n          </>\r\n        )}\r\n      </Box>\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}